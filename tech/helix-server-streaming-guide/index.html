<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用Helix Server建立点播流/直播流的方法 // Yuantops&#39; Blog</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:title" content="用Helix Server建立点播流/直播流的方法" />
<meta property="og:description" content="Helix Server是Real公司旗下的一款流媒体服务器，能提供稳定的视频点播服务（支持HTTP、RTSP多种协议），还提供生成模拟直播流的小工具（SLTA）。本文介绍用Helix Server生成直播流和点播流的方法。" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://blog.yuantops.com/tech/helix-server-streaming-guide/" />


    <link href="" rel="alternate" type="application/rss+xml" title="Yuantops&#39; Blog" />
    <link rel="shortcut icon" href="/favicon.ico">

    <link href="https://blog.yuantops.com/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://blog.yuantops.com/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://blog.yuantops.com/css/style.css">

    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <meta name="description" content="Helix Server是Real公司旗下的一款流媒体服务器，能提供稳定的视频点播服务（支持HTTP、RTSP多种协议），还提供生成模拟直播流的小工具（SLTA）。本文介绍用Helix Server生成直播流和点播流的方法。">
    <meta name="keywords" content="">
    <meta name="author" content="">

    <meta name="generator" content="Hugo 0.51-DEV" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://blog.yuantops.com/">Yuantops&#39; Blog</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/archives/">Archives</a>
                
                <a class="main-nav-link" href="/about/">About</a>
                
                <a class="main-nav-link" href="/index.xml">RSS</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">用Helix Server建立点播流/直播流的方法</h1>
        </header>
        
        <div class="article-meta">
            <a href="/tech/helix-server-streaming-guide/" class="article-date">
                <time datetime='2015-07-23T00:00:00.000&#43;00:00' itemprop="datePublished">2015-07-23</time>
            </a>
            
            
            <div class="post-categories">
                <div class="article-category">
                    
                    
                    <a class="article-category-link" href="https://blog.yuantops.com//categories/tech">Tech</a>
                    
                </div>
		
		<div class="article-category">
	      	  75字, 约1分钟读完
		</div>
	    

            </div>
            

	    
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            

<h2 id="视频文件预处理">视频文件预处理</h2>

<p>Helix Server支持的视频格式很多，我只使用过MP4格式，其余的格式请自行探索。</p>

<p>一个MP4格式的视频文件要想被Helix流化，必须具有符合要求的头部信息。mp4box这个小命令正是用来做这件事的，它是开源软件GPAC内提供的命令。先安装GPAC(<a href="https://gpac.wp.mines-telecom.fr/mp4box/)，">https://gpac.wp.mines-telecom.fr/mp4box/)，</a> 后在安装目录下找到MP4BOX.exe。如何调用命令不赘言。它的使用格式是：<br />
<code>mp4box mymovie.mp4 -hint</code><br />
在安装Helix Server前，将所有的视频文件都用这条命令处理一遍。</p>

<h2 id="安装">安装</h2>

<p>Helix Server是收费的，但在官网能申请到一个试用版license，免费使用一段时间。当然，如果你在网上找到了破解版，请在使用时自觉忏悔。</p>

<p>安装过程不多说，只是要注意记忆所设的帐号和密码。安装完成后，在桌面会生成两个图标：一个指向web控制台，还有一个是启动Helix的快捷方式。我们双击web控制台的图标，输入帐号和密码，进入Web Console。</p>

<h2 id="参数配置">参数配置</h2>

<p>进入Web Console后，左侧是一栏设置菜单，右侧是对应菜单条目的详情。在Web Console上我们能完成<strong>点播流</strong>的所有配置,以及直播流的必要配置。</p>

<ol>
<li><p>添加服务器的IP地址<br />
左侧：&rdquo;服务器设置&rdquo;-&ldquo;IP绑定&rdquo;<br />
右侧：点击小加号，输入服务器的IP地址。</p></li>

<li><p>配置流服务的端口号<br />
Helix 的点播支持Http协议、RTSP协议，直播支持RTSP协议。Helix为这些协议分配了默认的端口号，如果有需要的话我们可以修改它们。<br />
左侧：&rdquo;服务器设置&rdquo;-&ldquo;端口&rdquo;<br />
右侧：修改&rdquo;RTSP端口&rdquo;，&rdquo;HTTP端口&rdquo;。</p></li>

<li><p>添加视频加载点<br />
左侧：&rdquo;服务器设置&rdquo;-&ldquo;配置加载点&rdquo;<br />
右侧：点击&rdquo;加载点描述&rdquo;右边的小加号</p>

<ul>
<li>&ldquo;编辑描述&rdquo;随便给这个配置取一个描述性的名字；<br /></li>
<li>&ldquo;加载点&rdquo;设置视频目录的加载点（它将作为视频流URL的一部分出现），输入内容形如&rdquo;/NGB/&ldquo;（注意有两个左斜杠）；<br /></li>
<li>&ldquo;基于路径&rdquo;输入视频文件所在目录的绝对路径，形如&rdquo;E:\Videos&rdquo;。<br /></li>
</ul></li>

<li><p>将加载点添加到HTTP 分发目录<br />
左侧：&rdquo;服务器设置&rdquo;-&ldquo;HTTP分发&rdquo;<br />
右侧：点击&rdquo;路径&rdquo;右边的小加号，在&rdquo;编辑路径&rdquo;中填入上面设置的视频加载点，形如&rdquo;/NGB&rdquo;(注意此处只有一个左斜杠)。</p></li>

<li><p>将MP4格式加到HTTP协议支持的MIME类型列表<br />
左侧：&rdquo;服务器设置&rdquo;-&ldquo;MIME类型&rdquo;<br />
右侧：点击&rdquo;MIME类型&rdquo;右边的小加号</p>

<ul>
<li>&ldquo;编辑MIME类型&rdquo;填入&rdquo;video/mp4&rdquo;<br /></li>
<li>&ldquo;扩展名&rdquo;填入&rdquo;mp4&rdquo;<br /></li>
</ul></li>

<li><p>测试配置是否成功<br />
假设视频文件目录有文件&rdquo;E:\Videos\akame.mp4&rdquo;,视频目录挂载点为&rdquo;/NGB/&ldquo;,配置的Http协议端口为80，Rtsp协议端口为554。在PC上打开一个能播放网络媒体流的视频播放器（推荐VLC），输入下面的URL播放视频：</p>

<ul>
<li><a href="http://192.168.1.100:80/NGB/akame.mp4">http://192.168.1.100:80/NGB/akame.mp4</a><br /></li>
<li>rtsp://192.168.1.100:554/NGB/akame.mp4<br /></li>
</ul></li>
</ol>

<p>点播流的创建到此结束了。完成上述步骤后，下面再来介绍如何用Helix 提供的小命令，由视频文件生成模拟直播流。</p>

<h3 id="生成模拟直播流">生成模拟直播流</h3>

<ol>
<li><p>准备命令<br />
在Helix Server的安装路径下找到/bin目录，将slta.bat和slta.exe文件拷贝到视频目录（此处为&rdquo;E:\Videos\&ldquo;）。</p></li>

<li><p>配置Helix为Receiver模式<br />
打开Web Console。左侧：“广播分发”-“接受服务器”，在右侧“加载点”框内输入直播流的挂载点，例如&rdquo;/broadcast/&ldquo;（注意有两个左斜杠）。</p></li>

<li><p>运行模拟直播流命令<br />
模拟直播流播放哪几个视频，按什么顺序播放它们，是可以自己定义的。例如，如果想循环播放akame.mp4和anotheVideo.mp4这两个视频，我们可以创建一个节目单文本文件：playlist.txt，将“akame.mp4”和“anotheVideo.mp4”做两行写到文件。<br />
运行命令<code>slta.bat 192.168.1.100 178771 admin admin tv1 playlist.txt</code>创建直播流，其中：</p>

<ul>
<li>是slta.bat，而不是slta<br /></li>
<li>IP地址是这台机器的IP地址<br /></li>
<li>178771是Web Console的端口号。用浏览器打开Web Console，可以在URL中找到<br /></li>
<li>admin/admin分别是账号和密码<br /></li>
<li>tv1是为直播流分配的任意频道号，可自定义<br /></li>
<li>playlist.txt是节目单文件。如果只播放单个视频，也可以换成视频文件名，如&rdquo;akame.mp4&rdquo;<br /></li>
</ul></li>

<li><p>播放验证直播流<br />
打开视频播放器，输入形如&rdquo;rtsp://192.168.1.100:554/broadcast/tv1&rdquo;的网址，播放视频。</p></li>
</ol>

<p>上述步骤创建一个直播流。新开一个cmd窗口，重复上述步骤，可以创建多路直播流。</p>

        </div>

        
        
        <div class="article-toc" style="display:none;">
            <h3>Contents</h3>
            <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#视频文件预处理">视频文件预处理</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#参数配置">参数配置</a>
<ul>
<li><a href="#生成模拟直播流">生成模拟直播流</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
        </div>
        
        

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
        <script>
            (function() {
                var $toc = $('#TableOfContents');
                if ($toc.length > 0) {
                    var $window = $(window);

                    function onScroll(){
                        var currentScroll = $window.scrollTop();
                        var h = $('.article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6');
                        var id = "";
                        h.each(function (i, e) {
                            e = $(e);
                            if (e.offset().top - 10 <= currentScroll) {
                                id = e.attr('id');
                            }
                        });
                        var active = $toc.find('a.active');
                        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                        active.each(function (i, e) {
                            $(e).removeClass('active').siblings('ul').hide();
                        });
                        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                            $(e).children('a').addClass('active').siblings('ul').show();
                        });
                    }

                    $window.on('scroll', onScroll);
                    $(document).ready(function() {
                        $toc.find('a').parent('li').find('ul').hide();
                        onScroll();
                        document.getElementsByClassName('article-toc')[0].style.display = '';
                    });
                }
            })();
        </script>
        


        
    </div>
    <nav id="article-nav">
    
    <a href="/tech/surfaceview-dual-cache/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            Android SurfaceView双缓存机制与闪屏现象分析
        </div>
    </a>
    
    
    <a href="/tech/interview-ali-record-1/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Ali面试记录&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>
</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2012-2019 @yuantops&nbsp; </br>
            Proudly powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-57420914-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha256-ExtbCSBuYA7kq1Pz362ibde9nnsHYPt6JxuxYeZbU+c=" crossorigin="anonymous"></script>
        <script>renderMathInElement(document.body);</script>
    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
