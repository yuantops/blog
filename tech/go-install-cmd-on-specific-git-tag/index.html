<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Go从GitHub安装命令时指定commit/tag // Yuantops&#39; Blog</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:title" content="Go从GitHub安装命令时指定commit/tag" />
<meta property="og:description" content="Go的版本管理是一大痛点，最近我就亲身经历了一遭。这篇博客介绍一种非官方、指定git commit安装go命令的方法。" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://blog.yuantops.com/tech/go-install-cmd-on-specific-git-tag/" />


    <link href="" rel="alternate" type="application/rss+xml" title="Yuantops&#39; Blog" />
    <link rel="shortcut icon" href="/favicon.png">

    <link href="https://blog.yuantops.com/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://blog.yuantops.com/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://blog.yuantops.com/css/style.css">

    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <meta name="description" content="Go的版本管理是一大痛点，最近我就亲身经历了一遭。这篇博客介绍一种非官方、指定git commit安装go命令的方法。">
    <meta name="keywords" content="安装go命令指定commit,">
    <meta name="author" content="">

    <meta name="generator" content="Hugo 0.51-DEV" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://blog.yuantops.com/">Yuantops&#39; Blog</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/archives/">Archives</a>
                
                <a class="main-nav-link" href="/about/">About</a>
                
                <a class="main-nav-link" href="/index.xml">RSS</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Go从GitHub安装命令时指定commit/tag</h1>
        </header>
        
        <div class="article-meta">
            <a href="/tech/go-install-cmd-on-specific-git-tag/" class="article-date">
                <time datetime='2018-05-14T09:49:03.000&#43;00:00' itemprop="datePublished">2018-05-14</time>
            </a>
            
            
            <div class="post-categories">
                <div class="article-category">
                    
                    
                    <a class="article-category-link" href="https://blog.yuantops.com//categories/tech">Tech</a>
                    
                </div>
		
		<div class="article-category">
	      	  112字, 约1分钟读完
		</div>
	    

            </div>
            

	    
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>Go的版本管理是一大痛点，最近我就亲身经历了一遭。在<a href="https://blog.yuantops.com/tech/hugo-travis-ci-auto-deploy-to-gh-pages/">Blog自动部署实践</a>一文中，我把部署博客的工作流交给了Travis
CI。第二天，我照例打开Google Analytics查看访问量，发现前一天的访问量跌到0：一定出了什么问题。</p>

<p>我从GitHub上把 <code>gh-pages</code> 分支pull下来，grep我的Google Analysis跟踪码，居然没有。在本地用 <code>hugo</code>
命令生成静态文件，在public目录里发现每篇文章的html页面都包含Google Analytics跟踪代码。到此基本确定问题：Travis
CI build生成的静态网页货不对版，因为默认使用最新版本 <code>hugo</code> 命令，所以绝对是 <code>hugo</code> 版本更新导致的兼容问题。</p>

<p>解法也很简单，在 <code>.travis.yml</code> 文件里安装指定版本的 <code>hugo</code> 命令，让它和我本地<code>hugo</code>命令的版本号保持一致。</p>

<p><code>.travis.yml</code> 用go get安装Go命令。虽然官方不支持指定commit，但我在<a href="https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository">Stackoverflow:How to do
“go get” on a specific tag of a github
repository</a>
上找到了曲线救国方法，摘录如下：</p>

<pre><code>1. Run the get command without the tag - it should clone the master branch.
2. Move to the clone directory and checkout the tag or branch that you want.
3. Run the go get command again, it should process the command on the checked out branch.
</code></pre>

<p>事实上，这个方法行之有效。更新后， <code>.travis.yml</code> 文件的install部分长这样:</p>

<pre><code>install:
  - go get -d github.com/spf13/hugo 
  - cd $GOPATH/src/github.com/spf13/hugo
  - git checkout tags/v0.20.7
  - go get github.com/spf13/hugo
  - cd $TRAVIS_BUILD_DIR
  - hugo version
</code></pre>

<p>我指定安装v0.20.7版本的hugo，并手工打出版本号确认。重新部署后，Google Analytics统计恢复正常。</p>

        </div>

        
        
        

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
        <script>
            (function() {
                var $toc = $('#TableOfContents');
                if ($toc.length > 0) {
                    var $window = $(window);

                    function onScroll(){
                        var currentScroll = $window.scrollTop();
                        var h = $('.article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6');
                        var id = "";
                        h.each(function (i, e) {
                            e = $(e);
                            if (e.offset().top - 10 <= currentScroll) {
                                id = e.attr('id');
                            }
                        });
                        var active = $toc.find('a.active');
                        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                        active.each(function (i, e) {
                            $(e).removeClass('active').siblings('ul').hide();
                        });
                        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                            $(e).children('a').addClass('active').siblings('ul').show();
                        });
                    }

                    $window.on('scroll', onScroll);
                    $(document).ready(function() {
                        $toc.find('a').parent('li').find('ul').hide();
                        onScroll();
                        document.getElementsByClassName('article-toc')[0].style.display = '';
                    });
                }
            })();
        </script>
        


        
	
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://blog.yuantops.com//tags/golang">Golang
                    </a>
                </li>
                
            </ul>
        </footer>
        
	
    </div>
    <nav id="article-nav">
    
    <a href="/opinions/talk-between-wangshuo-and-xiaobo-review/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            诚实与圣徒——读《美人赠我蒙汗药》
        </div>
    </a>
    
    
    <a href="/tech/announcement-blog-https-supported/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">本博客现已支持HTTPS&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>
</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2012-2019 @yuantops&nbsp; </br>
            Proudly powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-57420914-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha256-ExtbCSBuYA7kq1Pz362ibde9nnsHYPt6JxuxYeZbU+c=" crossorigin="anonymous"></script>
        <script>renderMathInElement(document.body);</script>
    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
